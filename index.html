<!--https://d3-graph-gallery.com/graph/basic_datamanipulation.html very good-->
<!-- meaning of +???? -->
<!--Should there be a title????-->
<!--Legend????-->

<html lang="en-US">
	<head>
		<title>CS 416 Narrative Visualization Project</title>
		<script src='https://d3js.org/d3.v5.min.js'></script>
  	</head>
	<body onload='init()'>
		<!--
		<div>
			<h1 id="text">AAA</h1>
		</div>
		<div>
			<button onclick="changeText()" style="height:25px;width:50px" />
		</div>
		<br />
		-->
		<div>

        </div>
		<div>
			<svg width=600 height=600>
			</svg>
		</div>
		
		<div>
			<a href="page2.html">Next Slide</a>
		</div>	
	</body>
	<script>
		// function init() {
		async function init() {
			// MY CODE: 
					
			// var data = d3.csv("project_2_scatterplot_data.csv");
			var data = await d3.csv("https://raw.githubusercontent.com/jbao8899/CS-416-Narrative-Visualization-Project/main/project_2_data.csv");
			
            // console.log(data.length)

            // making scatterplot for a certain year
            data = data.filter(function(d) { return d.Year == "2020" })
            // get rid of data for which fertility rate or mortality rate under 5 are missing
            data = data.filter(function(d) { return d.FertilityRate != "" })
            data = data.filter(function(d) { return d.Under5DeathsPer1000 != "" })

            // console.log(data.length)
            console.log(d3.max(data, function(d) { return +d.value; }))

			var xScale = d3.scaleLinear().domain([0, 125]).range([0, 400])
			var yScale = d3.scaleLinear().domain([0, 8]).range([400, 0])
			
            // consistent color scheme 
            var colorScale = d3.scaleOrdinal()
                               .domain(["South Asia",
                                        "Europe & Central Asia",
                                        "Middle East & North Africa",
                                        "East Asia & Pacific",
                                        "Sub-Saharan Africa",
                                        "Latin America & Caribbean",
                                        "North America"])
                               .range(["violet",
                                       "indigo",
                                       "blue",
                                       "green",
                                       "yellow",
                                       "orange",
                                       "red"]);

			d3.select("svg")
			  .attr("width", 400 + 2 * 100)
			  .attr("height", 400 + 2 * 100)
			  .append("g")
			  .attr("transform","translate(100, 100)")
			  .selectAll("circle")
			  .data(data)
			  .enter()
			  .append("circle")
			  .attr("cx", function(d) { return xScale(d.Under5DeathsPer1000); })
			  .attr("cy", function(d) { return yScale(d.FertilityRate); })
			  .attr("r", 5)
              .style("fill", function(d, i) {return colorScale(d.Region);});
					  
			d3.select("svg")
			  .append("g")
			  .attr("transform", "translate(100, 100)")
			  .call(d3.axisLeft(yScale));
            
			d3.select("svg")
			  .append("g")
			  .attr("transform", "translate(100, 500)")
			  .call(d3.axisBottom(xScale));
            
            // https://stackoverflow.com/questions/11189284/d3-axis-labeling
            d3.select("svg")
              .append("text")
              .attr("class", "x label")
              .attr("text-anchor", "end")
              .attr("x", 420)
              .attr("y", 535)
              .text("Deaths Under 5 Per 1,000 Live Births");

            d3.select("svg")
              .append("text")
              .attr("class", "y label")
              .attr("text-anchor", "end")
              .attr("x", -255)
              .attr("y", 75)
              .attr("transform", "rotate(-90)")
              .text("Fertility Rate");

              console.log(data)
		}

		/*
		function changeText() {
			if (document.getElementById("text").innerHTML == "AAA") {
				document.getElementById("text").innerHTML = "BBB";
			}
			else {
				document.getElementById("text").innerHTML = "AAA";
			}
		}
		*/
	</script>
</html>
