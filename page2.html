<html lang="en-US">
	<head>
		<title>CS 416 Narrative Visualization Project</title>
		<script src='https://d3js.org/d3.v5.min.js'></script>
  	</head>
	<body onload='init()'>
		<!-- <div>
			<h1 id="text">Slide 2</h1>
		</div> -->

        <div>
			<svg width=600 height=600>
			</svg>
		</div>

		<div>
			<a href="index.html">Previous Slide</a>
			<a href="page3.html">Next Slide</a>
		</div>
	</body>

	<script>
		// function init() {
		async function init() {
			// MY CODE: 
					
			// var data = d3.csv("project_2_scatterplot_data.csv");
			var data = await d3.csv("https://raw.githubusercontent.com/jbao8899/CS-416-Narrative-Visualization-Project/main/project_2_data.csv");
			
            // making bar chart for a certain year
            data = data.filter(function(d) { return d.Year == "2020" })
            // get rid of data for which fertility rate is missing
            data = data.filter(function(d) { return d.FertilityRate != "" })
            
            // What does this do????
            // https://stackoverflow.com/a/40206462
            data = d3.nest()
                     .key(
                          function(d) {
                              return d.Region; 
                          }
                      )
                      .rollup(
                              function(leaves) {
                                  return d3.mean(leaves, function(d) { return d.FertilityRate; });
                              })
                      .entries(data)
                      .map(function(d) {
                          return { Region: d.key, FertilityRate: d.value};
                      });

            console.log(data)
            
            var xScale = d3.scaleBand().domain([0, 1, 2, 3, 4, 5, 6]).range([0, 400])
			var yScale = d3.scaleLinear().domain([0, 5]).range([400, 0])

			d3.select("svg")
			  .attr("width", 400 + 2 * 100)
			  .attr("height", 400 + 2 * 100)
			  .append("g")
			  .attr("transform","translate(100, 100)")
			  .selectAll("rect")
			  .data(data)
			  .enter()
			  .append("rect")
              .attr("x", function(d, i) { return 14 + ((400 / 7) * i) })
              .attr("y", function(d) { return 400 - ((d.FertilityRate / 5) * 400) })
              .attr("width", 200 / 7)
              .attr("height", function(d) { return (d.FertilityRate / 5) * 400 });
					  
			d3.select("svg")
			  .append("g")
			  .attr("transform", "translate(100, 100)")
			  .call(d3.axisLeft(yScale));
            
			d3.select("svg")
			  .append("g")
			  .attr("transform", "translate(100, 500)")
			  .call(d3.axisBottom(xScale));

		}

		/*
		function changeText() {
			if (document.getElementById("text").innerHTML == "AAA") {
				document.getElementById("text").innerHTML = "BBB";
			}
			else {
				document.getElementById("text").innerHTML = "AAA";
			}
		}
		*/
	</script>
</html>
